/**
 * @file Generated by er-sync, module
 * @author Luics<xukai01@baidu.com>
 * @date Wed Apr 01 2015 15:20:58 GMT+0800 (CST)
 * Copyright (c) 2012 Baidu.com, Inc. All Rights Reserved
 * shortcut mf.m.highchart_overview
 */
(function (exports, module) {
    var emptyData = {
        "click": 0,
        "impression": 0,
        "request": 0,
        "served_request": 0,
        "ctr": 0
    };

    var highchart_hourview = function (element, lists) {
        var dateLength = 24;
        lists = [].concat(lists);
        if (lists.length < 1) {
            $(element).hide();
            return;
        }
        lists.sort(function (a, b) {
            return a['hour'] > b['hour'] ? 1 : -1;
        });
        $.each(new Array(dateLength), function (index) {
            if (mf.m.utils.indexOfArray(lists, index + '', 'hour') === -1) {
                lists.splice(index, 0, $.extend({}, emptyData, {hour: index}));
            }
        });
        console.log('chart original', lists);
        var cData = {};
        $.each(lists, function (index, item) {
            $.each(item, function (key, value) {
                cData[key] || (cData[key] = []);
                cData[key].push(value);
            });
        });
        $(element).show().highcharts({
            chart: {
                spacingTop: 60,
                marginTop: 60
            },
            title: {
                text: null
            },
            colors: [
                "#1c62b8",
                "#f6505c",
                "#f6c928",
                "#19b2b7",
                "#8772cd",
                "#eb6f25"
            ],
            credits: {
                enabled: false
            },
            exporting: {
                enabled: false
            },
            tooltip: {
                shared: true,
                crosshairs: {
                    width: 2,
                    color: 'gray',
                    dashStyle: 'shortdot'
                }
            },
            legend: {
                align: 'left',
                verticalAlign: 'top',
                itemMarginTop: -40,
                floating: true,
                itemStyle: {
                    fontWeight: 'normal',
                    color: '#777',
                    fontSize: 12,
                    symbolPadding: 10
                },
                itemDistance: 20
            },
            plotOptions: {
                line: {
                    marker: {
                        symbol: 'circle',
                        radius: 2
                    },
                    lineWidth: 1
                },
                spline: {
                    marker: {
                        enabled: false
                    }
                }
            },
            xAxis: [
                {
                    categories: cData.hour,
                    lineColor: '#e5e5e5',
                    tickColor: '#e5e5e5',
                    labels: {
                        style: {
                            color: '#7a7a7a'
                        }
                    },
                    tickPosition: 'inside',
                    tickLength: 4,
                    tickmarkPlacement: 'on'
                }
            ],
            yAxis: [
                { // Primary yAxis
                    min: 0,
                    gridLineWidth: 0,
                    title: {
                        text: null
                    },
                    labels: {
                        align: 'left',
                        formatter: function () {
                            return this.value + '次';
                        },
                        enabled: true
                    },
                    opposite: true
                }, { // Secondary yAxis
                    min: 0,
                    gridLineWidth: 0,
                    title: {
                        text: null
                    },
                    labels: {
                        formatter: function () {
                            return this.value + '次';
                        },
                        enabled: false
                    }
                },
                { // 3th yAxis
                    min: 0,
                    gridLineWidth: 0,
                    title: {
                        text: null
                    },
                    labels: {
                        enabled: false
                    }
                }
            ],
            series: [
                {
                    name: '展现数',
                    type: 'line',
                    yAxis: 0,
                    lineWidth: 2,
                    data: cData.impression,
                    tooltip: {
                        valueSuffix: ' 次'
                    }

                }, {
                    name: '点击数',
                    type: 'line',
                    yAxis: 1,
                    lineWidth: 2,
                    data: cData.click,
                    tooltip: {
                        valueSuffix: ' 次'
                    }
                },
                {
                    name: '请求数',
                    type: 'line',
                    yAxis: 0,
                    lineWidth: 2,
                    data: cData.request,
                    tooltip: {
                        valueSuffix: ' 次'
                    },
                    visible: false

                },
                {
                    name: '点击率',
                    type: 'line',
                    data: cData.ctr,
                    yAxis: 2,
                    lineWidth: 2,
                    tooltip: {
                        valueDecimals: 2,
                        valueSuffix: '%'
                    },
                    visible: false
                }
            ]
        });
    };
    exports.highchart_hourview = highchart_hourview;
})(mf && mf.m || exports || {}, mf || module);