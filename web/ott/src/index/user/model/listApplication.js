/**
 * @file Generated by er-sync
 * @author Luics<xukai01@baidu.com>
 * @date Mon Sep 22 2014 10:36:40 GMT+0800 (中国标准时间)
 * Copyright (c) 2012 Baidu.com, Inc. All Rights Reserved
 */
(function () {
    var FIELDS = function (model) {
        var fileds = [
            {
                title: '序号',
                stable: 1,
                width: 40,
                align: 'center',
                content: function (item, index) {
                    return index + 1;
                }
            },
            {
                title: '姓名',
                content: 'name'
            },
            {
                title: '性别',
                content: 'gender'
            },
            {
                title: '申请职位',
                content: 'position'
            },
            {
                title: '电话',
                content: 'mobile'
            },
            {
                title: '邮箱',
                content: 'email'
            },
            {
                title: '工作经验',
                content: function (item) {
                    return '<div class="limited">' + item.experience + '</div>'
                }
            },
            {
                title: '申请时间',
                content: function (item) {
                    return item.apply_date && T.date.format(new Date(item.apply_date), mf.DATE_TIME_FORMAT);
                }
            },
            {
                title: '状态',
                content: function (item) {
                    return [
                        '等待处理',
                        '已经受理',
                        '作废'
                    ][item.status || 0];
                }
            },
            {
                title: '处理时间',
                content: function (item) {
                    return item.view_date && dateFormat(item.view_date) || '-';
                }
            },
            {
                title: '操作',
                content: function (item, index) {
                    var html = [];
                    if (item.status) {
                        html.push('<a data-cmd="status_0" data-index="' + index + '">未处理</a>')
                    }
                    if (item.status !== 1) {
                        html.push('<a data-cmd="status_1" data-index="' + index + '">已受理</a>')
                    }
                    if (item.status !== 2) {
                        html.push('<a data-cmd="status_2" data-index="' + index + '">作废</a>')
                    }
                    if (item.status === 2) {
                        html.push('<a data-cmd="delete" data-index="' + index + '">删除</a>')
                    }
                    return html.join('&nbsp;');
                }
            }
        ];
        return fileds;
    };
    mf.index.user.model.listApplication = new er.Model({
        QUERY_MAP: {
            currentPage: 'page',
            pageSize: 'pageSize',
            status: 'status',
            keyType: 'keyType',
            keyWord: 'keyWord'
        },
        LOADER_LIST: ['modelLoader'],
        modelLoader: new er.Model.Loader(function () {
            console.log('modelLoader');
            var loader = this;
            loader.stop();
            mf.get(
                'index/user/listApplication?' + loader.getQueryString(),
                function (model) {
                   mf.initModel({loader: loader, model: model, fields: FIELDS});
                   loader.start();
                }
            );
        })
    });
})();